<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pandian Stores</title>
    <style>
      #heading {
        margin-top: 90px;
        text-decoration: underline;
      }
      #div {
        margin-top: 40px;
      }
    </style>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="p-3">
    <h3 class="text-center" id="heading">Pandian Stores</h3>

    <!-- Category Buttons -->
    <div class="text-center mb-3" id="div">
      <button class="btn btn-danger" onclick="filterCategory('chocolate')">
        Chocolates
      </button>
      <button class="btn btn-warning" onclick="filterCategory('masala')">
        Masala
      </button>
      <button class="btn btn-success" onclick="filterCategory('soap')">
        Soap
      </button>
      <button class="btn btn-secondary" onclick="filterCategory('shampoo')">
        Shampoo
      </button>
      <button class="btn btn-dark" onclick="displayProducts(products)">
        All
      </button>
    </div>

    <div class="text-center mb-3">
      <select id="categorySelect" class="form-select w-auto d-inline-block">
        <option value="all">All Categories</option>
        <option value="chocolate">Chocolates</option>
        <option value="masala">Masala</option>
        <option value="soap">Soap</option>
        <option value="shampoo">Shampoo</option>
      </select>
    </div>

    <!-- Price Filter + Sort -->
    <div class="text-center mb-3">
      <input type="number" id="minPrice" placeholder="Min Price" />
      <input type="number" id="maxPrice" placeholder="Max Price" />
      <button class="btn btn-info" onclick="filterByPrice()">
        Filter by Price
      </button>
      <button class="btn btn-secondary" onclick="displayProducts(products)">
        Reset
      </button>

      <!-- main sort button -->
      <button class="btn btn-primary" onclick="showSortOptions()">Sort</button>

      <!-- hidden buttons initially -->
      <span id="sortOptions" style="display: none">
        <button class="btn btn-success" onclick="sortIncreasing()">
          Price ↑
        </button>
        <button class="btn btn-danger" onclick="sortDecreasing()">
          Price ↓
        </button>
      </span>
    </div>
    <input type="text" id="search" class="form-control" placeholder="Search" />

    <!-- Table -->
    <table class="table table-bordered table-striped table-hover text-center">
      <thead>
        <tr>
          <th>Product Id</th>
          <th>Product Name</th>
          <th>Product Price</th>
        </tr>
      </thead>
      <tbody id="display-data"></tbody>
    </table>

    <script>
      let products = [
        { id: 47, name: "Dairy Milk", price: 120, category: "chocolate" },
        { id: 21, name: "Milk bar", price: 100, category: "chocolate" },
        { id: 46, name: "Mysore Sandal", price: 121, category: "soap" },
        { id: 171, name: "Biriyani Masala", price: 150, category: "masala" },
        { id: 36, name: "Karthika Shampoo", price: 123, category: "shampoo" },
        { id: 144, name: "Z Soap", price: 169, category: "soap" },
      ];

      function displayProducts(list) {
        let data = document.getElementById("display-data");
        data.innerHTML = "";
        list.forEach(function (p) {
          data.innerHTML +=
            "<tr><td>" +
            p.id +
            "</td><td>" +
            p.name +
            "</td><td>" +
            p.price +
            "</td></tr>";
        });
      }

      function filterCategory(cat) {
        let filtered = products.filter(function (p) {
          return p.category === cat;
        });
        displayProducts(filtered);
      }

      function filterByPrice() {
        let min = parseInt(document.getElementById("minPrice").value) || 0;
        let max =
          parseInt(document.getElementById("maxPrice").value) || Infinity;
        let filtered = products.filter(function (p) {
          return p.price >= min && p.price <= max;
        });
        displayProducts(filtered);
      }

      // show/hide the two sort buttons
      function showSortOptions() {
        let options = document.getElementById("sortOptions");
        if (options.style.display === "none") {
          options.style.display = "inline";
        } else {
          options.style.display = "none";
        }
      }

      function sortIncreasing() {
        let list = [...products];
        list.sort(function (a, b) {
          return a.price - b.price;
        });
        displayProducts(list);
      }

      function sortDecreasing() {
        let list = [...products];
        list.sort(function (a, b) {
          return b.price - a.price;
        });
        displayProducts(list);
      }
      let search = document.getElementById("search");
      search.addEventListener("keyup", function (event) {
        let searchItem = event.target.value.toLowerCase();
        let searchedItem = products.filter((ele) =>
          ele.name.toLowerCase().includes(searchItem)
        );
        displayProducts(searchedItem);
      });

      document
        .getElementById("categorySelect")
        .addEventListener("change", function (e) {
          filterCategory(e.target.value);
        });
    </script>
  </body>
</html>
